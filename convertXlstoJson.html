<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"
    ></script>
	
	
	
	<style>
        th, td, p, input {
            font:14px Verdana;
        }
        table, th, td 
        {
            border: solid 4px #DDD;
            border-collapse: collapse;
            padding: 10px 5px;
            text-align: center;
        }
        th {
            font-weight:bold;
        }
    </style>
	
	
  </head>

  <body>
  
    <input type="file" id="fileUpload" accept=".xls,.xlsx" /><br />
   <!-- <button type="button" id="uploadExcel">Convert</button>  -->
  <!--  <pre id="jsonData"></pre>  -->
  <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for names.." title="Type in a name">
	<p id="jsonData"></p>
  </body>
  

  
  
 
  
  
  
  
  <script>
    var selectedFile;
    document
      .getElementById("fileUpload")
      .addEventListener("change", function(event) {
        selectedFile = event.target.files[0];
   /*   });
    document
      .getElementById("uploadExcel")
      .addEventListener("click", function() {  */
        if (selectedFile) {
          console.log("hi");
          var fileReader = new FileReader();
          fileReader.onload = function(event) {
            var data = event.target.result;

            var workbook = XLSX.read(data, {
              type: "binary"
            });
			 let rowObject1;
			  let rowObject2;
            workbook.SheetNames.forEach(sheet => {
			if(sheet == 'Sheet1'){
             rowObject1 = XLSX.utils.sheet_to_row_object_array(
                workbook.Sheets[sheet]
              ); }
			  else {
             rowObject2 = XLSX.utils.sheet_to_row_object_array(
                workbook.Sheets[sheet]
              ); }
			  let myBooks = rowObject1;
              let jsonObject = JSON.stringify(rowObject1);
			  console.log(jsonObject)
             document.getElementById("jsonData").innerHTML = jsonObject;
            localStorage.setItem("rowObject1", JSON.stringify(rowObject1));
			localStorage.setItem("rowObject2", JSON.stringify(rowObject2));
				
			  
			  // start
			  
	/*		  
			   var col = [];
        for (var i = 0; i < myBooks.length; i++) {
            for (var key in myBooks[i]) {
                if (col.indexOf(key) === -1) {
                    col.push(key);
                }
            }
        }

        // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");

        // CREATE HTML TABLE HEADER ROW USING THE EXTRACTED HEADERS ABOVE.

        var tr = table.insertRow(-1);                   // TABLE ROW.

        for (var i = 0; i < col.length; i++) {
            var th = document.createElement("td");      // TABLE HEADER.
            th.innerHTML = col[i];
            tr.appendChild(th);
        }

        // ADD JSON DATA TO THE TABLE AS ROWS.
        for (var i = 0; i < myBooks.length; i++) {

            tr = table.insertRow(-1);

            for (var j = 0; j < col.length; j++) {
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = myBooks[i][col[j]];
            }
        }

        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("showData");
		divContainer.innerHTML = "";
        divContainer.appendChild(table);  */
            });  
          };   
          fileReader.readAsBinaryString(selectedFile);
		  window.location.replace("demo.html");
		  
        }
      });
  </script>
</html>
